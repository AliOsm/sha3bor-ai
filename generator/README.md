# شعبور - مُؤلِّف الشعر

يختص هذا المكوّن بتدريب وتطوير النماذج التي بإمكانها تأليف الشعر بناءً على:

1- كلمة أو مجموعة كلمات.  
2- صدر بيت.  
3- بحر وقافية معينين.  
4- موضوع.  
5- عشوائيًّا.  
6- مجموعة من الخيارات السابقة مجتمعة.  

## النماذج المستخدمة

لتطوير هذا المكوّن قمنا بإجراء التجارب على النماذج التالية:

<p dir="rtl">
1- <a href="https://huggingface.co/aubmindlab/aragpt2-base"><code>AraGPT2-base</code></a> من AUBMindLab.<br>
2- <a href="https://huggingface.co/aubmindlab/aragpt2-medium"><code>AraGPT2-medium</code></a> من AUBMindLab.<br>
</p>

## طريقة التدريب

تم تدريب النماذج السابقة لتوقّع الكلمة التالية بناءً على الكلمات السابقة (Causal Language Modeling). كذلك تم استعمال أسلوب تكوين النصوص الشرطي (Conditional Text Generation) لتمرير معلومات البحر والقافية للنموذج أثناء التدريب من خلال إرفاق رموز خاصة بالبحر والقافية.

كمثال، إذا كانت المدخلات للنموذج خلال التدريب هي:

> إِنَّ العُيونَ الَّتي في طَرفِها حَوَرٌ *** قَتَلنَنا ثُمَّ لَم يُحيِينَ قَتلانا  
> يَصرَعنَ ذا اللُبَّ حَتّى لا حِراكَ بِهِ *** وَهُنَّ أَضعَفُ خَلقِ اللَهِ أَركانا

وكان البحر بسيطًا والقافية نونًا، فسيتم تحويل المدخلات إلى:

> إِنَّ العُيونَ الَّتي في طَرفِها حَوَرٌ `[شطر]` قَتَلنَنا ثُمَّ لَم يُحيِينَ قَتلانا `[بسيطن]` يَصرَعنَ ذا اللُبَّ حَتّى لا حِراكَ بِهِ `[شطر]` وَهُنَّ أَضعَفُ خَلقِ اللَهِ أَركانا `[بسيطن]`

هذه الطريقة في معالجة المدخلات مفيدةٌ جدًّا كي يتعلَّم النموذج الفروقات بين البحور والقوافي المختلفة. كذلك هي مفيدة جدا عند تأليف القصائد باستخدام النموذج كي نستطيع تقطيع النص بشكل دقيق، فالنموذج سيقوم بكتابة الرموز `[شطر]` و `[بسيطن]` (أو أي رمز آخر لبحر وقافية مختلفين) خلال عملية التأليف. أخيرا، يمكننا تأليف قصائد لبحر وقافية معينين من خلال النموذج إذا منعناه من إنتاج رموز تخص أي بحر وقافية غير البحر والقافية المطلوبين.

## استعمال الشفرة البرمجية للتدريب والتأليف

يوجد 3 خطوات أساسية يجب تنفيذها لتدريب نموذج جديد وتأليف الشعر من خلاله، وهي:

### تجهيز البيانات

لتجهيز البيانات، يجب أن تقوم بتشغيل ملف `filter_and_process_data.py` من خلال تنفيذ الأمر التالي:

```
python filter_and_process_data.py
```

### تدريب النموذج

من خلال ملف `finetune.py` يمكنك تدريب النموذج من الصفر لتأليف الشعر من خلال تنفيذ الأمر التالي:

```
python finetune.py --model_size base
```

يمكنك اختيار حجم النموذج الذي تريد تدريبه. كذلك يمكن تحديد المتغيرات المتعلقة بعملية التدريب كعدد الأمثلة في حزمة التدريب الواحدة.

### التأليف باستخدام النموذج

للتأليف يمكنك استعمال ملف `generate.py` من خلال تنفيذ الأمر التالي:

```
python generate.py --model_name_or_path aliosm/sha3bor-generator-aragpt2-base --model_size base
```

يمكنك التحكم بالعديد من خيارات التأليف، ألقِ نظرةً على الخيارات المتاحة من خلال تنفيذ الأمر:

```
python generate.py --help
```

## النماذج المدربة

يمكنك الحصول على النماذج المدربة من خلال HuggingFace Hub:

1- [aliosm/sha3bor-generator-aragpt2-base](https://huggingface.co/aliosm/sha3bor-generator-aragpt2-base)  
2- [aliosm/sha3bor-generator-aragpt2-medium](https://huggingface.co/aliosm/sha3bor-generator-aragpt2-medium)

## أفكار للتطوير

<p>
- تدريب نماذج أكثر مثل <code>AraGPT2-large</code>.<br>
- تجربة أشكال مختلفة من أسلوب تكوين النصوص الشرطي.
</p>
